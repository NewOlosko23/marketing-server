{"level":"error","message":"Email service initialization failed: nodemailer.createTransporter is not a function","service":"marketing-firm-api","stack":"TypeError: nodemailer.createTransporter is not a function\n    at EmailService.initializeTransporter (C:\\Users\\Olosko\\Desktop\\Projects\\data\\law\\backend\\services\\emailService.js:15:37)\n    at new EmailService (C:\\Users\\Olosko\\Desktop\\Projects\\data\\law\\backend\\services\\emailService.js:9:10)\n    at Object.<anonymous> (C:\\Users\\Olosko\\Desktop\\Projects\\data\\law\\backend\\services\\emailService.js:270:18)\n    at Module._compile (node:internal/modules/cjs/loader:1706:14)\n    at Object..js (node:internal/modules/cjs/loader:1839:10)\n    at Module.load (node:internal/modules/cjs/loader:1441:32)\n    at Function._load (node:internal/modules/cjs/loader:1263:12)\n    at TracingChannel.traceSync (node:diagnostics_channel:322:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)\n    at Module.require (node:internal/modules/cjs/loader:1463:12)","timestamp":"2025-09-30 13:41:12"}
{"code":"EAUTH","command":"API","level":"error","message":"Email service initialization failed: Missing credentials for \"PLAIN\"","service":"marketing-firm-api","stack":"Error: Missing credentials for \"PLAIN\"\n    at SMTPConnection._formatError (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:809:19)\n    at SMTPConnection.login (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:454:38)\n    at C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-transport\\index.js:375:32\n    at SMTPConnection.<anonymous> (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:215:17)\n    at Object.onceWrapper (node:events:633:28)\n    at SMTPConnection.emit (node:events:519:28)\n    at SMTPConnection._actionEHLO (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:1371:14)\n    at SMTPConnection._processResponse (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:993:20)\n    at SMTPConnection._onData (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:774:14)\n    at SMTPConnection._onSocketData (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:195:44)","timestamp":"2025-09-30 13:50:29"}
{"level":"error","message":"MongoDB connection error: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","reason":{"commonWireVersion":0,"compatible":true,"heartbeatFrequencyMS":10000,"localThresholdMS":15,"logicalSessionTimeoutMinutes":null,"maxElectionId":null,"maxSetVersion":null,"servers":{},"setName":null,"stale":false,"type":"Unknown"},"service":"marketing-firm-api","stack":"MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n    at _handleConnectionErrors (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\mongoose\\lib\\connection.js:816:11)\n    at NativeConnection.openUri (C:\\Users\\Olosko\\desktop\\projects\\data\\law\\backend\\node_modules\\mongoose\\lib\\connection.js:791:11)","timestamp":"2025-09-30 14:03:34"}
{"level":"error","message":"File parsing error: Cannot access 'fs' before initialization","service":"marketing-firm-api","stack":"ReferenceError: Cannot access 'fs' before initialization\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:77:7\n    at newFn (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\express-async-errors\\index.js:16:20)\n    at Layer.handle [as handle_request] (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at done (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\lib\\make-middleware.js:47:7)\n    at indicateDone (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\lib\\make-middleware.js:51:68)\n    at C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\lib\\make-middleware.js:157:11\n    at WriteStream.<anonymous> (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\storage\\disk.js:43:9)\n    at WriteStream.emit (node:events:531:35)\n    at finish (node:internal/streams/writable:955:10)","timestamp":"2025-10-01 17:44:02"}
{"level":"error","message":"File parsing error: Cannot access 'fs' before initialization","service":"marketing-firm-api","stack":"ReferenceError: Cannot access 'fs' before initialization\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:77:7\n    at newFn (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\express-async-errors\\index.js:16:20)\n    at Layer.handle [as handle_request] (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at done (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\lib\\make-middleware.js:47:7)\n    at indicateDone (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\lib\\make-middleware.js:51:68)\n    at C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\lib\\make-middleware.js:157:11\n    at WriteStream.<anonymous> (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\multer\\storage\\disk.js:43:9)\n    at WriteStream.emit (node:events:531:35)\n    at finish (node:internal/streams/writable:955:10)","timestamp":"2025-10-01 17:47:36"}
{"level":"error","message":"Excel parsing error: XLSX.readFile is not a function","service":"marketing-firm-api","stack":"TypeError: XLSX.readFile is not a function\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:120:33\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 17:50:17"}
{"level":"error","message":"File parsing error: Failed to parse Excel file: XLSX.readFile is not a function","service":"marketing-firm-api","stack":"Error: Failed to parse Excel file: XLSX.readFile is not a function\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:161:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 17:50:17"}
{"level":"error","message":"Excel parsing error: XLSX.readFile is not a function","service":"marketing-firm-api","stack":"TypeError: XLSX.readFile is not a function\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:120:33\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 18:05:02"}
{"level":"error","message":"File parsing error: Failed to parse Excel file: XLSX.readFile is not a function","service":"marketing-firm-api","stack":"Error: Failed to parse Excel file: XLSX.readFile is not a function\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:161:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 18:05:02"}
{"level":"error","message":"Excel parsing error: Cannot read properties of undefined (reading '0')","service":"marketing-firm-api","stack":"TypeError: Cannot read properties of undefined (reading '0')\n    at firstbyte (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\xlsx\\xlsx.js:23625:27)\n    at Module.readSync (C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\node_modules\\xlsx\\xlsx.js:23706:14)\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:120:33\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 18:16:14"}
{"level":"error","message":"File parsing error: Failed to parse Excel file: Cannot read properties of undefined (reading '0')","service":"marketing-firm-api","stack":"Error: Failed to parse Excel file: Cannot read properties of undefined (reading '0')\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:161:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 18:16:14"}
{"level":"error","message":"Excel parsing error: XLSX.readFile is not a function","service":"marketing-firm-api","stack":"TypeError: XLSX.readFile is not a function\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:128:29\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 18:19:06"}
{"level":"error","message":"File parsing error: Failed to parse Excel file: XLSX.readFile is not a function","service":"marketing-firm-api","stack":"Error: Failed to parse Excel file: XLSX.readFile is not a function\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:187:19\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-01 18:19:06"}
{"code":"ENOENT","errno":-4058,"level":"error","message":"File parsing error: ENOENT: no such file or directory, unlink 'C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\uploads\\72d0b7d90188a6cd1c1aca736896bd2d'","path":"C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\uploads\\72d0b7d90188a6cd1c1aca736896bd2d","service":"marketing-firm-api","stack":"Error: ENOENT: no such file or directory, unlink 'C:\\Users\\Olosko\\Desktop\\Projects\\marketing\\backend\\uploads\\72d0b7d90188a6cd1c1aca736896bd2d'\n    at Object.unlinkSync (node:fs:1952:11)\n    at file:///C:/Users/Olosko/Desktop/Projects/marketing/backend/routes/upload.js:240:10\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"unlink","timestamp":"2025-10-01 18:43:28"}
